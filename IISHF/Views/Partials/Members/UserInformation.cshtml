@model IISHF.Core.Models.AccountViewModel

<div id="myDetails" class="col-12 col-sm-12 col-md-6 col-lg-6 mb-5">
    <div class="col-12">
        <div class="tab-content" id="v-pills-tabContent">
            <div class="tab-pane fade shadow rounded bg-white show active p-5" id="v-pills-team" role="tabpanel" aria-labelledby="v-pills-team-tab">

                <h2 class="mb-3 text-center">My Details</h2>
                <div id="successResult"></div>
                <div class="form-group row mb-2">
                    @Html.LabelFor(m => m.Name, new { @class = "col-form-label col-md-4", placeholder = "Full Name" })
                    <div class="col-md-8">
                        @Html.TextBoxFor(m => m.Name, new { @class = "form-control", placeholder = "Full Name" })
                    </div>
                </div>
                @* <div class="form-group row mb-2">
                    @Html.LabelFor(m => m.Email, new { @class = "col-form-label col-md-4", placeholder = "Email Address" })
                    <div class="col-md-8">
                        @Html.TextBoxFor(m => m.Email, new { @class = "form-control", placeholder = "Email Address", type = "email", autocomplete = "off", disabled = "disabled" })
                    </div>
                </div> *@
                <div class="form-group row mb-2">
                    @Html.LabelFor(m => m.Password, new { @class = "col-form-label col-md-4", placeholder = "New Password" })
                    <div class="col-md-8">
                        @Html.TextBoxFor(m => m.Password, new { @class = "form-control", placeholder = "New Password", type = "password" })
                    </div>
                </div>
                <div class="form-group row mb-2">
                    @Html.LabelFor(m => m.ConfirmPassword, new { @class = "col-form-label col-md-4", placeholder = "New Password" })
                    <div class="col-md-8">
                        @Html.TextBoxFor(m => m.ConfirmPassword, new { @class = "form-control", placeholder = "New Password", type = "password" })
                    </div>
                </div>
                <span class="btn btn-secondary" id="update" value="">Update details</span>
            </div>
        </div>
    </div>
</div>

<script>

    $(document).ready(function () {

        // This is so that password manager doesnt accidently 
        // update the form and change a user name by accident
        setTimeout(function () { 
        @{
            <text>
            $("#Email").val('@Model.Email')
            </text>
        }
        }, 1000)

        $("#update").on("click", function () {

            // Create an object with the form data
            var formData = {
                Name: $("#Name").val(),
                Email: $("#Email").val(),
                Username: $("#Email").val(), // Assuming you want to duplicate the Email value
                Password: $("#Password").val() === "" ? null : $("#Password").val(),
                ConfirmPassword: $("#ConfirmPassword").val() === "" ? null : $("#ConfirmPassword").val()
            };

            $.ajax({
                type: "PUT",
                url: "/api/account/update-details",
                data: JSON.stringify(formData),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (result) {
                    console.log("Updated successfully");
                    var html = "<div class=\"alert alert-success\" role=\"alert\">Your details have been updated</div>"
                    $("#successResult").html(html);
                    // Slide down the div
                    $("#successResult").slideDown(500);

                    // Set a timeout to slide up the div after 5 seconds
                    setTimeout(function () {
                        $("#successResult").slideUp(500);
                    }, 5000);

                },
                error: function (result) {
                    console.log(result);
                }
            });

        })
    })

</script>